sudo snap set microk8s api-extra-sans=10.196.142.223 192.168.1.36

sudo microk8s refresh-certs --cert <cert_name>

sudo microk8s status --wait-ready


############# HELM UPGRADE COMMAND #################################################


helm upgrade --install qr-app charts/qr-app -n qr --create-namespace --set fullnameOverride=qr-app

helm upgrade --install qr-app charts/qr-app -n qr -f charts/qr-app/values.yaml \ 
--set-string image.backend=ghcr.io/zazanicholas01/qr-backend:sha-acf26bc \
--set-string image.frontend=ghcr.io/zazanicholas01/qr-frontend:sha-acf26bc \
--set fullnameOverride=qr-app


############# USEFUL COMMANDS ########################################################

    - KUBERNETES
        - Apply Certificates
            - kubectl -n qr apply -f kube_certs/cert-selfsigned.yaml
            - kubectl -n qr apply -f kube_certs/app-cert.yaml
        
        - Wait for secret to be ready
            - kubectl -n qr get certificate web-cert -w

        - Rollout Restart & Status Watching
            - kubectl -n qr rollout restart deployment/qr-app-backend
            - kubectl -n qr rollout restart deployment/qr-app-frontend
            - kubectl -n qr rollout status deployment/qr-app-backend
            - kubectl -n qr rollout status deployment/qr-app-frontend

    - MOBILE COMMUNICATION
        - If LAN IP Changes
            - Update FRONTEND_PUBLIC_URL in values.yaml
            - Update ipAddresses and ingress.tls / ingress.hosts IP Entries
            - Re-Apply Certificate and Upgrade Helm        
